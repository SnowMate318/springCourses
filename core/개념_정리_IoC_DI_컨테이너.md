# IoC, DI, 컨테이너 개념


### IoC (제어의 역전)

* 기존 프로그램은 구현 객체가 스스로 필요한 서버 구현 객체를 생성하고 연결하고 실행함
  * 구현 객체가 프로그램의 제어 흐름을 스스로 조종함
  * 개발자 입장에서는 자연스러운 흐름임
* 반면에, AppConfig가 등장한 이후 구현 객체는 자신의 로직을 실행하는 역할만 담당함
  * 프로그램의 제어 흐름은 AppConfig가 가져감
  * OrderServiceImpl은 인터페이스에 어떤 구현체가 있는지 모른 채 그냥 실행함
* 프로그램에 대한 제어 흐름에 대한 권한은 모두 AppConfig가 가지고있음
  * 심지어 OrderServiceImpl도 AppConfig가 생성함
  * AppConfig는 OrderServiceImpl이 아닌 다른 OrderService 구현객체를 실행할 수도 있음(아직 만들지는 않음)
  * 이렇게 AppConfig를 통해 프로그램 흐름을 외부에서 제어하는 방법을 IoC(제어의 역전)이라 한다.



### 프레임워크 vs 라이브러리



JUNIT -> 프레임워크

* 프로그램 제어권을 프레임워크(JUNIT)이 가짐
* BeforeEach 후 테스트함수 실행 -> JUNIT의 독자적인 프로세스

반면에 프로그램 제어권을 가지지않는 것은 라이브러리



### DI(의존관계 주입)


* OrderServiceImpl은 DiscountPolicy 인터페이스에 의존
* 실제 어떤 구현 객체가 사용되는지는 OrderServiceImpl은 모름
* 의존관계는 **정적인 의존관계**와 **실행 시점에서 결정되는 동적인 객체(인스턴스)** 로 분리해야한다.


#### 정적 클래스 의존관계
클래스가 사용하는 import코드만 보고 의존관계를 쉽게 판단가능

eg) 디스카운트, 멤버 등 클래스



#### 동적 클래스 의존관계

* **어플리케이션 실행 시점(런타임)** 에 외부에서 구현 객체를 생성하고 클라이언트에 전달해서 클라이언트와 서버의 실제 의존관계가 연결되는것을 **의존관계 주입**이라고 함
* 객체 인스턴스를 생성하고, 그 참조값을 전달하여 연결함
* 의존관계 주입을 사용하면 클라이언트 코드를 변경하지않고, 클라이언트가 호출하는 대상의 타입 인스턴스 변경 가능
  * FixDiscountPolicy에서 RateDiscountPolicy로 변경하거나
* 의존관계 주입을 사용하면 정적 클래스 의존관계를 변경하지않고, 동적 객체 인스턴스 의존관계를 쉽게 변경 가능
  * 정적 클래스 의존관계 다이어그램을 전혀 손대지 않음(어플리케이션 코드를 변경하지 않음)



### IOC 컨테이너, DI 컨테이너

* AppConfig를 IoC컨테이너 또는 DI 컨테이너라고 함
* 

